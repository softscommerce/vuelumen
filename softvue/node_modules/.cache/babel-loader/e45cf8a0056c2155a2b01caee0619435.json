{"ast":null,"code":"import { createWebHistory, createRouter } from \"vue-router\";\n\nconst HomePage = () => import('@/components/main/HomePage.vue');\n\nconst LoginPage = () => import('@/components/main/LoginPage.vue');\n\nconst ServicePage = () => import('@/components/main/ServicePage.vue');\n\nconst Test = () => import('@/components/main/Test.vue');\n\nimport auth from '@/middleware/auth.js';\nimport User from '../middleware/User'; // import GeneralRoutes from \"./router.js\";\n// import PropertyRoutes from \"./property.js\";\n// var allRoutes = [];\n// // allRoutes = allRoutes.concat(GeneralRoutes, PropertyRoutes);\n// allRoutes = allRoutes.concat(GeneralRoutes);\n// const routes = allRoutes;\n\nconst routes = [{\n  path: \"/\",\n  name: \"Home-page\",\n  component: HomePage,\n  meta: {\n    middleware: [auth]\n  }\n}, {\n  path: \"/login\",\n  name: \"Login-page\",\n  component: LoginPage,\n  meta: {\n    middleware: [auth]\n  }\n}, {\n  path: \"/service\",\n  name: \"Service-page\",\n  component: ServicePage,\n  meta: {\n    middleware: [auth]\n  }\n}, {\n  path: \"/test\",\n  name: \"test\",\n  component: Test\n}]; // const needsAuth = false;\n\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n});\n\nfunction nextFactory(context, middleware, index) {\n  const subsquentMiddleware = middleware[index];\n\n  if (!subsquentMiddleware) {\n    return context.next;\n  }\n\n  return (...parameters) => {\n    context.next(...parameters);\n    const nextMiddleware = nextFactory(context, middleware, index + 1);\n    subsquentMiddleware({ ...context,\n      next: nextMiddleware\n    });\n  };\n}\n\nrouter.beforeEach((to, from, next) => {\n  if (to.meta.middleware) {\n    const middleware = Array.isArray(to.meta.middleware) ? to.meta.middleware : [to.meta.middleware];\n    const context = {\n      from,\n      next,\n      router,\n      to\n    };\n    const nextMiddleware = nextFactory(context, middleware, 1);\n    return middleware[0]({ ...context,\n      next: nextMiddleware\n    });\n  }\n\n  return next();\n}); // router.beforeEach((to, from, next) => {\n//   if(to.meta.requiresAuth && !needsAuth){\n//     next({ name: 'Test' })\n//     // return {\n//     //   path: '/',\n//     // }\n//   }\n//   next();\n// });\n// console.log(router);\n\nexport default router;","map":{"version":3,"names":["createWebHistory","createRouter","HomePage","LoginPage","ServicePage","Test","auth","User","routes","path","name","component","meta","middleware","router","history","nextFactory","context","index","subsquentMiddleware","next","parameters","nextMiddleware","beforeEach","to","from","Array","isArray"],"sources":["F:/softvue/src/router/index.js"],"sourcesContent":["import { createWebHistory, createRouter } from \"vue-router\";\r\nconst HomePage = () => import('@/components/main/HomePage.vue');\r\nconst LoginPage = () => import('@/components/main/LoginPage.vue');\r\nconst ServicePage = () => import('@/components/main/ServicePage.vue');\r\nconst Test = () => import('@/components/main/Test.vue');\r\nimport auth from '@/middleware/auth.js';\r\nimport User from '../middleware/User'\r\n// import GeneralRoutes from \"./router.js\";\r\n// import PropertyRoutes from \"./property.js\";\r\n\r\n// var allRoutes = [];\r\n// // allRoutes = allRoutes.concat(GeneralRoutes, PropertyRoutes);\r\n// allRoutes = allRoutes.concat(GeneralRoutes);\r\n\r\n// const routes = allRoutes;\r\n\r\nconst routes = [\r\n  {\r\n    path: \"/\",\r\n    name: \"Home-page\",\r\n    component: HomePage,\r\n    meta:{\r\n      middleware:[auth]\r\n    }\r\n  },\r\n  {\r\n    path: \"/login\",\r\n    name: \"Login-page\",\r\n    component: LoginPage,\r\n    meta:{\r\n      middleware:[auth]\r\n    }\r\n  },\r\n  {\r\n    path: \"/service\",\r\n    name: \"Service-page\",\r\n    component: ServicePage,\r\n    meta:{\r\n      middleware:[auth]\r\n    }\r\n  },\r\n\r\n  {\r\n    path: \"/test\",\r\n    name: \"test\",\r\n    component: Test\r\n  }\r\n];\r\n\r\n// const needsAuth = false;\r\n\r\nconst router = createRouter({\r\n  history: createWebHistory(),\r\n  routes,\r\n});\r\n\r\n\r\nfunction nextFactory(context, middleware, index){\r\n  const subsquentMiddleware = middleware[index];\r\n  if(!subsquentMiddleware){\r\n    return context.next;\r\n  }\r\n\r\n  return (...parameters) => {\r\n    context.next(...parameters);\r\n    const nextMiddleware = nextFactory(context, middleware, index+1);\r\n    subsquentMiddleware({...context, next:nextMiddleware});\r\n  };\r\n}\r\n\r\n\r\n\r\nrouter.beforeEach((to, from, next) => {\r\n  if(to.meta.middleware){\r\n    const middleware = Array.isArray(to.meta.middleware)? to.meta.middleware : [to.meta.middleware];\r\n    const context = {from , next, router, to};\r\n    const nextMiddleware = nextFactory(context, middleware, 1);\r\n    return middleware[0]({...context, next:nextMiddleware});\r\n  }\r\n\r\n  return next();\r\n    \r\n});\r\n\r\n// router.beforeEach((to, from, next) => {\r\n//   if(to.meta.requiresAuth && !needsAuth){\r\n//     next({ name: 'Test' })\r\n//     // return {\r\n//     //   path: '/',\r\n//     // }\r\n//   }\r\n//   next();\r\n// });\r\n\r\n// console.log(router);\r\n\r\nexport default router;   "],"mappings":"AAAA,SAASA,gBAAT,EAA2BC,YAA3B,QAA+C,YAA/C;;AACA,MAAMC,QAAQ,GAAG,MAAM,OAAO,gCAAP,CAAvB;;AACA,MAAMC,SAAS,GAAG,MAAM,OAAO,iCAAP,CAAxB;;AACA,MAAMC,WAAW,GAAG,MAAM,OAAO,mCAAP,CAA1B;;AACA,MAAMC,IAAI,GAAG,MAAM,OAAO,4BAAP,CAAnB;;AACA,OAAOC,IAAP,MAAiB,sBAAjB;AACA,OAAOC,IAAP,MAAiB,oBAAjB,C,CACA;AACA;AAEA;AACA;AACA;AAEA;;AAEA,MAAMC,MAAM,GAAG,CACb;EACEC,IAAI,EAAE,GADR;EAEEC,IAAI,EAAE,WAFR;EAGEC,SAAS,EAAET,QAHb;EAIEU,IAAI,EAAC;IACHC,UAAU,EAAC,CAACP,IAAD;EADR;AAJP,CADa,EASb;EACEG,IAAI,EAAE,QADR;EAEEC,IAAI,EAAE,YAFR;EAGEC,SAAS,EAAER,SAHb;EAIES,IAAI,EAAC;IACHC,UAAU,EAAC,CAACP,IAAD;EADR;AAJP,CATa,EAiBb;EACEG,IAAI,EAAE,UADR;EAEEC,IAAI,EAAE,cAFR;EAGEC,SAAS,EAAEP,WAHb;EAIEQ,IAAI,EAAC;IACHC,UAAU,EAAC,CAACP,IAAD;EADR;AAJP,CAjBa,EA0Bb;EACEG,IAAI,EAAE,OADR;EAEEC,IAAI,EAAE,MAFR;EAGEC,SAAS,EAAEN;AAHb,CA1Ba,CAAf,C,CAiCA;;AAEA,MAAMS,MAAM,GAAGb,YAAY,CAAC;EAC1Bc,OAAO,EAAEf,gBAAgB,EADC;EAE1BQ;AAF0B,CAAD,CAA3B;;AAMA,SAASQ,WAAT,CAAqBC,OAArB,EAA8BJ,UAA9B,EAA0CK,KAA1C,EAAgD;EAC9C,MAAMC,mBAAmB,GAAGN,UAAU,CAACK,KAAD,CAAtC;;EACA,IAAG,CAACC,mBAAJ,EAAwB;IACtB,OAAOF,OAAO,CAACG,IAAf;EACD;;EAED,OAAO,CAAC,GAAGC,UAAJ,KAAmB;IACxBJ,OAAO,CAACG,IAAR,CAAa,GAAGC,UAAhB;IACA,MAAMC,cAAc,GAAGN,WAAW,CAACC,OAAD,EAAUJ,UAAV,EAAsBK,KAAK,GAAC,CAA5B,CAAlC;IACAC,mBAAmB,CAAC,EAAC,GAAGF,OAAJ;MAAaG,IAAI,EAACE;IAAlB,CAAD,CAAnB;EACD,CAJD;AAKD;;AAIDR,MAAM,CAACS,UAAP,CAAkB,CAACC,EAAD,EAAKC,IAAL,EAAWL,IAAX,KAAoB;EACpC,IAAGI,EAAE,CAACZ,IAAH,CAAQC,UAAX,EAAsB;IACpB,MAAMA,UAAU,GAAGa,KAAK,CAACC,OAAN,CAAcH,EAAE,CAACZ,IAAH,CAAQC,UAAtB,IAAmCW,EAAE,CAACZ,IAAH,CAAQC,UAA3C,GAAwD,CAACW,EAAE,CAACZ,IAAH,CAAQC,UAAT,CAA3E;IACA,MAAMI,OAAO,GAAG;MAACQ,IAAD;MAAQL,IAAR;MAAcN,MAAd;MAAsBU;IAAtB,CAAhB;IACA,MAAMF,cAAc,GAAGN,WAAW,CAACC,OAAD,EAAUJ,UAAV,EAAsB,CAAtB,CAAlC;IACA,OAAOA,UAAU,CAAC,CAAD,CAAV,CAAc,EAAC,GAAGI,OAAJ;MAAaG,IAAI,EAACE;IAAlB,CAAd,CAAP;EACD;;EAED,OAAOF,IAAI,EAAX;AAED,CAVD,E,CAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AAEA,eAAeN,MAAf"},"metadata":{},"sourceType":"module"}