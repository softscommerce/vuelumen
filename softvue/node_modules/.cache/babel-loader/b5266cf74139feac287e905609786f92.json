{"ast":null,"code":"import { createWebHistory, createRouter } from \"vue-router\";\n\nconst HomePage = () => import('@/components/main/HomePage.vue');\n\nconst LoginPage = () => import('@/components/main/LoginPage.vue');\n\nconst ServicePage = () => import('@/components/main/ServicePage.vue');\n\nconst Test = () => import('@/components/main/Test.vue');\n\nimport auth from '@/middleware/auth.js';\nimport User from '../middleware/User'; // import GeneralRoutes from \"./router.js\";\n// import PropertyRoutes from \"./property.js\";\n// var allRoutes = [];\n// // allRoutes = allRoutes.concat(GeneralRoutes, PropertyRoutes);\n// allRoutes = allRoutes.concat(GeneralRoutes);\n// const routes = allRoutes;\n\nconst requireNoAuth = (to, from, next) => {\n  let user = User.logedIn();\n\n  if (user) {\n    next({\n      name: \"Home-page\"\n    });\n  }\n\n  next();\n};\n\nconst routes = [{\n  path: \"/\",\n  name: \"Home-page\",\n  component: HomePage\n}, {\n  path: \"/login\",\n  name: \"Login-page\",\n  component: LoginPage,\n  beforeEnter: requireNoAuth\n}, {\n  path: \"/service\",\n  name: \"Service-page\",\n  component: ServicePage,\n  meta: {\n    middleware: [auth]\n  }\n}, {\n  path: \"/test\",\n  name: \"test\",\n  component: Test\n}]; // const needsAuth = false;\n\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n});\n\nfunction nextFactory(context, middleware, index) {\n  const subsquentMiddleware = middleware[index];\n\n  if (!subsquentMiddleware) {\n    return context.next;\n  }\n\n  return (...parameters) => {\n    context.next(...parameters);\n    const nextMiddleware = nextFactory(context, middleware, index + 1);\n    subsquentMiddleware({ ...context,\n      next: nextMiddleware\n    });\n  };\n}\n\nrouter.beforeEach((to, from, next) => {\n  if (to.meta.middleware) {\n    const middleware = Array.isArray(to.meta.middleware) ? to.meta.middleware : [to.meta.middleware];\n    const context = {\n      from,\n      next,\n      router,\n      to\n    };\n    const nextMiddleware = nextFactory(context, middleware, 1);\n    return middleware[0]({ ...context,\n      next: nextMiddleware\n    });\n  }\n\n  return next();\n}); // router.beforeEach((to, from, next) => {\n//   if(to.meta.requiresAuth && !needsAuth){\n//     next({ name: 'Test' })\n//     // return {\n//     //   path: '/',\n//     // }\n//   }\n//   next();\n// });\n// console.log(router);\n\nexport default router;","map":{"version":3,"names":["createWebHistory","createRouter","HomePage","LoginPage","ServicePage","Test","auth","User","requireNoAuth","to","from","next","user","logedIn","name","routes","path","component","beforeEnter","meta","middleware","router","history","nextFactory","context","index","subsquentMiddleware","parameters","nextMiddleware","beforeEach","Array","isArray"],"sources":["F:/softvue/src/router/index.js"],"sourcesContent":["import { createWebHistory, createRouter } from \"vue-router\";\r\nconst HomePage = () => import('@/components/main/HomePage.vue');\r\nconst LoginPage = () => import('@/components/main/LoginPage.vue');\r\nconst ServicePage = () => import('@/components/main/ServicePage.vue');\r\nconst Test = () => import('@/components/main/Test.vue');\r\nimport auth from '@/middleware/auth.js';\r\nimport User from '../middleware/User'; \r\n// import GeneralRoutes from \"./router.js\";\r\n// import PropertyRoutes from \"./property.js\";\r\n\r\n// var allRoutes = [];\r\n// // allRoutes = allRoutes.concat(GeneralRoutes, PropertyRoutes);\r\n// allRoutes = allRoutes.concat(GeneralRoutes);\r\n\r\n// const routes = allRoutes;\r\n\r\nconst requireNoAuth = (to, from, next) => {\r\n  let user = User.logedIn();\r\n  if (user) {\r\n    next({ name: \"Home-page\" });\r\n  }\r\n  next();\r\n};\r\n\r\nconst routes = [\r\n  {\r\n    path: \"/\",\r\n    name: \"Home-page\",\r\n    component: HomePage\r\n  },\r\n  {\r\n    path: \"/login\",\r\n    name: \"Login-page\",\r\n    component: LoginPage,\r\n    beforeEnter: requireNoAuth,\r\n  },\r\n  {\r\n    path: \"/service\",\r\n    name: \"Service-page\",\r\n    component: ServicePage,\r\n    meta:{\r\n      middleware:[auth]\r\n    }\r\n  },\r\n\r\n  {\r\n    path: \"/test\",\r\n    name: \"test\",\r\n    component: Test\r\n  }\r\n];\r\n\r\n// const needsAuth = false;\r\n\r\nconst router = createRouter({\r\n  history: createWebHistory(),\r\n  routes,\r\n});\r\n\r\n\r\nfunction nextFactory(context, middleware, index){\r\n  const subsquentMiddleware = middleware[index];\r\n  if(!subsquentMiddleware){\r\n    return context.next;\r\n  }\r\n\r\n  return (...parameters) => {\r\n    context.next(...parameters);\r\n    const nextMiddleware = nextFactory(context, middleware, index+1);\r\n    subsquentMiddleware({...context, next:nextMiddleware});\r\n  };\r\n}\r\n\r\n\r\n\r\nrouter.beforeEach((to, from, next) => {\r\n  if(to.meta.middleware){\r\n    const middleware = Array.isArray(to.meta.middleware)? to.meta.middleware : [to.meta.middleware];\r\n    const context = {from , next, router, to};\r\n    const nextMiddleware = nextFactory(context, middleware, 1);\r\n    return middleware[0]({...context, next:nextMiddleware});\r\n  }\r\n\r\n  return next();\r\n    \r\n});\r\n\r\n// router.beforeEach((to, from, next) => {\r\n//   if(to.meta.requiresAuth && !needsAuth){\r\n//     next({ name: 'Test' })\r\n//     // return {\r\n//     //   path: '/',\r\n//     // }\r\n//   }\r\n//   next();\r\n// });\r\n\r\n// console.log(router);\r\n\r\nexport default router;   "],"mappings":"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"},"metadata":{},"sourceType":"module"}